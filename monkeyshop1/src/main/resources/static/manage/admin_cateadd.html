<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="../js/jquery-1.12.4.min.js"></script>
    <script src="../js/jquery.cookie.js"></script>
</head>
<body>

<div class="sidebar-wrap">
    <div class="sidebar-title">
        <h1>菜单</h1>
    </div>
    <div class="sidebar-content">
        <ul class="sidebar-list">
            <li>
                <a href="#"><i class="icon-font">&#xe003;</i>常用操作</a>
                <ul class="sub-menu">
                    <li><a href="admin_user.html"><i class="icon-font">&#xe008;</i>用户管理</a></li>
                    <li><a href="admin_cate.html"><i class="icon-font">&#xe005;</i>分类管理</a></li>
                    <li><a href="design.html"><i class="icon-font">&#xe006;</i>商品管理</a></li>
                    <li><a href="design.html"><i class="icon-font">&#xe004;</i>订单管理</a></li>
                    <li><a href="design.html"><i class="icon-font">&#xe012;</i>新闻管理</a></li>
                </ul>
            </li>
            <li>
                <a href="#"><i class="icon-font">&#xe018;</i>系统管理</a>
                <ul class="sub-menu">
                    <li><a href="system.html"><i class="icon-font"></i>修改密码</a></li>
                    <!--            <li><a href="system.html"><i class="icon-font"></i>系统设置</a></li>-->
                    <!--            <li><a href="system.html"><i class="icon-font"></i>清理缓存</a></li>-->
                    <!--            <li><a href="system.html"><i class="icon-font"></i>数据备份</a></li>-->
                    <!--            <li><a href="system.html"><i class="icon-font"></i>数据还原</a></li>-->
                </ul>
            </li>
        </ul>
    </div>
</div>
<!--/sidebar-->

<div class="main-wrap">

    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="index.html">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">作品管理</span></div>
    </div>
    <div class="search-wrap">
        <div class="search-content">
            <form action="#" method="post">
                <table class="search-tab">
                    <tr>
                        <th width="120">父级分类:</th>
                        <td>
                            <select name="search-sort" id="search-sort">
                                <option value="">全部</option>
                                <option value="19">精品界面</option><option value="20">推荐界面</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <th width="70">请输入分类名称:</th>
                        <td><input id="keywords" class="common-text" placeholder="关键字" name="" value=""  type="text"></td>
                        <td><input id="cateadd" class="btn btn-primary btn2" name="sub" value="提交" type="submit"></td>
                    </tr>
                </table>
            </form>
        </div>
    </div>
<!--    <div class="result-wrap">-->
<!--        <form name="myform" id="myform" method="post">-->
<!--            <div class="result-title">-->
<!--                <div class="result-list">-->
<!--                    <a href="insert.html"><i class="icon-font"></i>新增作品</a>-->
<!--                    <a id="batchDel" href="javascript:void(0)"><i class="icon-font"></i>批量删除</a>-->
<!--                    <a id="updateOrd" href="javascript:void(0)"><i class="icon-font"></i>更新排序</a>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="result-content">-->
<!--                <table class="result-tab" width="100%">-->
<!--                    <tr>-->
<!--                        <th class="tc" width="5%"><input class="allChoose" name="" type="checkbox"></th>-->
<!--                        <th>排序</th>-->
<!--                        <th>ID</th>-->
<!--                        <th>标题</th>-->
<!--                        <th>审核状态</th>-->
<!--                        <th>点击</th>-->
<!--                        <th>发布人</th>-->
<!--                        <th>更新时间</th>-->
<!--                        <th>评论</th>-->
<!--                        <th>操作</th>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                        <td class="tc"><input name="id[]" value="59" type="checkbox"></td>-->
<!--                        <td>-->
<!--                            <input name="ids[]" value="59" type="hidden">-->
<!--                            <input class="common-input sort-input" name="ord[]" value="0" type="text">-->
<!--                        </td>-->
<!--                        <td>59</td>-->
<!--                        <td title="发哥经典"><a target="_blank" href="#" title="发哥经典">发哥经典</a> …-->
<!--                        </td>-->
<!--                        <td>0</td>-->
<!--                        <td>2</td>-->
<!--                        <td>admin</td>-->
<!--                        <td>2014-03-15 21:11:01</td>-->
<!--                        <td></td>-->
<!--                        <td>-->
<!--                            <a class="link-update" href="#">修改</a>-->
<!--                            <a class="link-del" href="#">删除</a>-->
<!--                        </td>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                        <td class="tc"><input name="id[]" value="58" type="checkbox"></td>-->
<!--                        <td>-->
<!--                            <input name="ids[]" value="58" type="hidden">-->
<!--                            <input class="common-input sort-input" name="ord[]" value="0" type="text">-->
<!--                        </td>-->
<!--                        <td>58</td>-->
<!--                        <td title="黑色经典"><a target="_blank" href="#" title="黑色经典">黑色经典</a> …-->
<!--                        </td>-->
<!--                        <td>0</td>-->
<!--                        <td>35</td>-->
<!--                        <td>admin</td>-->
<!--                        <td>2013-12-30 22:34:00</td>-->
<!--                        <td></td>-->
<!--                        <td>-->
<!--                            <a class="link-update" href="#">修改</a>-->
<!--                            <a class="link-del" href="#">删除</a>-->
<!--                        </td>-->
<!--                    </tr>-->
<!--                </table>-->
<!--&lt;!&ndash;                <div class="list-page"> 2 条 1/1 页</div>&ndash;&gt;-->
<!--            </div>-->
<!--        </form>-->
<!--    </div>-->
</div>

<!--    <iframe src="admin_user.html" style="height: 800px;width: 100%;overflow: scroll;overflow-y: hidden;overflow-x: hidden;"></iframe>-->
<!--/main-->
</div>
<script type="text/javascript">
    $(document).ready(function (){
        findByCate_id();
    });

    //添加分类
    $("#cateadd").click(function (){
        var catePatentId = $("#search-sort option:selected").val();
        var keywords = $("#keywords").val();
        var parmt = "?catePatentId="+catePatentId+"&cateName="+keywords;
        // alert("catePatentId:"+catePatentId+"cateName:"+keywords);
        $.ajax({
            url:"/category/add"+parmt,
            type:"POST",
            dataType:"json",
            success:function (json){
                if (json.state == 200){
                    alert("添加成功");
                    location.href = "admin_cate.html";
                }else {
                    alert("用户加载不成功，请重新加载页面");
                    // location.href = "../login.html";
                }
            },
            error:function (xhr){
                alert("加载时产生未知的错误："+xhr.status);
            }
        });
    });

    //查询所有一级分类
    function findByCate_id(){
        $("#search-sort").empty();
        $.ajax({
            url:"/category/findAll",
            type:"GET",
            dataType:"json",
            success:function (json){
                if (json.state == 200){
                    let parent = json.data.parent;

                    let h = '<option value="0" selected="selected">根目录</option>';
                    $("#search-sort").append(h);
                    for (let i=0;i<parent.length;i++){

                     let html = '<option value="#{cateId}">#{cateName}</option>';

                        html = html.replace(/#{cateId}/g,parent[i].cateId);
                        html = html.replace(/#{cateName}/g,parent[i].cateName);
                        $("#search-sort").append(html);
                    }
                }else {
                    alert("用户加载不成功，请重新加载页面");
                    location.href = "../login.html";
                }
            },
            error:function (xhr){
                alert("加载时产生未知的错误："+xhr.status);
            }
        });
    }

</script>
</body>
</html>